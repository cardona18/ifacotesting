<?xml version="1.0" encoding="UTF-8" ?>
<openerp>
    <data>
    <record model="ir.ui.view" id="purchase_requisition_partner_form">
            <field name="name">purchase_requisition_partner</field>
            <field name="model">purchase.requisition.partner</field>
            <field name="inherit_id" ref="purchase_requisition.view_purchase_requisition_partner"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="replace">
                    <group attrs="{'invisible':[('create_new_partner','=',True)] }">
                        <field name="is_manufacturing" readonly="0"/>
                        <field name='order_id' readonly="1"/>
                        <field name="manufacturing_partner_id" attrs="{'invisible':[('is_manufacturing','=',False)],'required':[('is_manufacturing','=',True),('create_new_partner','=',False)] }" domain="[('supplier','=', True),('provider_for_manufacturing','=', True)]" options="{'no_create':True, 'create_edit': false,'no_open': false}"/>
                        <field name="partner_id" attrs="{'invisible':[('is_manufacturing','=',True)], 'required':[('is_manufacturing','=',False),('create_new_partner','=',False)]}" domain="[('supplier','=', True),('provider_for_manufacturing','=', False)]"  options="{'no_create':True, 'create_edit': false,'no_open': false}"/>

                        <!-- <field name='partner_ava' invisible="1"/> -->
                    </group>

                    <group>
                        <field name="create_new_partner" readonly="False"/>
                    </group>

                    <group attrs="{'invisible':[('create_new_partner','=',False)] }">
                        <group>
                            <field name="name" attrs="{'required':[('create_new_partner','=',True)] }"/>
                            <field name="supplier_rfc"/>
                            <html lang="es">
                                <a href="https://portalsat.plataforma.sat.gob.mx/ConsultaRFC/captcha.faces" target="_blank">Ir a pagina del sat para validar RFC</a>
                            </html>
                        </group>

                        <group>
                            <field name="supplier_ledger_name" attrs="{'required':[('create_new_partner','=',True)] }"/>
                            <field name="email" attrs="{'required':[('create_new_partner','=',True)] }"/>
                            <field name="property_account_payable" attrs="{'required':[('create_new_partner','=',True)] }" widget="selection"/>
                        </group>

                    </group>

                </xpath>

                <xpath expr="//footer/button[@name='create_order']" position="replace">
                    <button name="create_order_gi" type="object" string="Crear solicitud de cotización" class="oe_highlight" attrs="{'invisible':[('create_new_partner','=',True)] }"/>
                </xpath>

                <xpath expr="//footer/button[@name='create_order_gi']" position="before">
                    <button name="create_res_partner" type="object" string="Crear y agregar prooveedor en borrador" class="oe_highlight" attrs="{'invisible':[('create_new_partner','=',False)] }"/>
                </xpath>


<!--                 <xpath expr="//footer/button[@name='create_order']" position="attributes">
                    <attribute name="string">Crear solicitud de cotización</attribute>
                    <attribute name="attrs">{'invisible':[('create_new_partner','=',True)] }</attribute>
                </xpath> -->

            </field>
        </record>
   	</data>
</openerp>
